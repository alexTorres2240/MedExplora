<template>

</template>

<script setup>
import { inject, onUnmounted } from "vue";
import { whenever } from "@vueuse/core";
import { MAP_INJECTION_KEY } from "./ScriptGoogleMaps.vue";
const props = defineProps({
  options: { type: Object, required: false }
});
const eventsWithoutPayload = [
  "center_changed",
  "radius_changed"
];
const eventsWithMapMouseEventPayload = [
  "click",
  "dblclick",
  "drag",
  "dragend",
  "dragstart",
  "mousedown",
  "mousemove",
  "mouseout",
  "mouseover",
  "mouseup",
  "rightclick"
];
const emit = defineEmits([]);
const mapContext = inject(MAP_INJECTION_KEY, void 0);
let circle = void 0;
whenever(() => mapContext?.map.value && mapContext.mapsApi.value, () => {
  circle = new mapContext.mapsApi.value.Circle({
    map: mapContext.map.value,
    ...props.options
  });
  setupCircleEventListeners(circle);
  whenever(() => props.options, (options) => {
    circle?.setOptions(options);
  }, {
    deep: true
  });
}, {
  immediate: true,
  once: true
});
onUnmounted(() => {
  if (!circle || !mapContext?.mapsApi.value) {
    return;
  }
  mapContext.mapsApi.value.event.clearInstanceListeners(circle);
  circle.setMap(null);
});
function setupCircleEventListeners(circle2) {
  eventsWithoutPayload.forEach((event) => {
    circle2.addListener(event, () => emit(event));
  });
  eventsWithMapMouseEventPayload.forEach((event) => {
    circle2.addListener(event, (payload) => emit(event, payload));
  });
}
</script>
