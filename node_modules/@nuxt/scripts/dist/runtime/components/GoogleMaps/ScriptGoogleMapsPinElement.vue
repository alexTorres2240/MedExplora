<template>

</template>

<script setup>
import { inject, shallowRef } from "vue";
import { whenever } from "@vueuse/core";
import { MAP_INJECTION_KEY } from "./ScriptGoogleMaps.vue";
import { ADVANCED_MARKER_ELEMENT_INJECTION_KEY } from "./ScriptGoogleMapsAdvancedMarkerElement.vue";
const props = defineProps({
  options: { type: Object, required: false }
});
const mapContext = inject(MAP_INJECTION_KEY, void 0);
const advancedMarkerElementContext = inject(ADVANCED_MARKER_ELEMENT_INJECTION_KEY, void 0);
const pinElement = shallowRef(void 0);
whenever(
  () => mapContext?.map.value && mapContext.mapsApi.value && advancedMarkerElementContext?.advancedMarkerElement.value,
  async () => {
    await mapContext.mapsApi.value.importLibrary("marker");
    pinElement.value = new mapContext.mapsApi.value.marker.PinElement(props.options);
    if (advancedMarkerElementContext?.advancedMarkerElement.value) {
      advancedMarkerElementContext.advancedMarkerElement.value.content = pinElement.value.element;
    }
    whenever(() => props.options, (options) => {
      if (pinElement.value && options) {
        Object.assign(pinElement.value, options);
      }
    }, {
      deep: true
    });
  },
  {
    immediate: true,
    once: true
  }
);
</script>
